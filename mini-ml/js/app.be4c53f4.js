(function(t){function e(e){for(var r,s,o=e[0],u=e[1],l=e[2],f=0,d=[];f<o.length;f++)s=o[f],a[s]&&d.push(a[s][0]),a[s]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);c&&c(e);while(d.length)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,o=1;o<n.length;o++){var u=n[o];0!==a[u]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},a={app:0},i=[];function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/mini-ml/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var c=u;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var r=n("64a9"),a=n.n(r);a.a},"255f":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},i=[],s=(n("034f"),n("2877")),o={},u=Object(s["a"])(o,a,i,!1,null,null,null);u.options.__file="App.vue";var l=u.exports,c=n("8c4f"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("MiniMnist")],1)},d=[],h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mini-mnist"},[n("canvas",{ref:"mnistDraw",attrs:{id:"mnist-draw",width:"280",height:"280"},on:{mousedown:t.handleDrawMouseDown,mousemove:t.handleDrawMouseMove,mouseup:t.handleDrawMouseUp,mouseout:t.handleDrawMouseUp}}),n("canvas",{ref:"mnistHidden",attrs:{id:"mnist-hidden",width:"28",height:"28"}}),n("div",[n("button",{on:{click:t.handleClear}},[t._v("Clear")])]),n("div",[t._v("\n    "+t._s(t.answer)+"\n  ")])])},m=[],p=n("3835"),v=(n("96cf"),n("1da1")),w=n("b994"),g={name:"MiniMnist",data:function(){return{model:null,drawing:!1,lastMousePos:{x:0,y:0},answer:null}},methods:{handleDrawMouseDown:function(t){this.drawing=!0,this.lastMousePos.x=t.offsetX,this.lastMousePos.y=t.offsetY;var e=this.$refs.mnistDraw.getContext("2d");e.lineWidth=15,e.lineCap="round",e.lineJoin="round",e.beginPath()},handleDrawMouseMove:function(t){if(this.drawing){var e=this.$refs.mnistDraw.getContext("2d");e.moveTo(this.lastMousePos.x,this.lastMousePos.y),e.lineTo(t.offsetX,t.offsetY),e.stroke(),this.lastMousePos.x=t.offsetX,this.lastMousePos.y=t.offsetY}},centerImage:function(t){for(var e=0,n=0,r=t.length,a=t[0].length,i=0,s=0;s<r;s++)for(var o=0;o<a;o++){var u=1-t[s][o];i+=u,n+=s*u,e+=o*u}e/=i,n/=i;var l=Math.round(r/2-n),c=Math.round(a/2-e);return{transX:c,transY:l}},getBoundingRectangle:function(t,e){for(var n=t.length,r=t[0].length,a=r,i=n,s=-1,o=-1,u=0;u<n;u++)for(var l=0;l<r;l++)t[u][l]<e&&(a>l&&(a=l),s<l&&(s=l),i>u&&(i=u),o<u&&(o=u));return{minY:i,minX:a,maxY:o,maxX:s}},imageDataToGrayscale:function(t){for(var e=[],n=0;n<t.height;n++){e[n]=[];for(var r=0;r<t.width;r++){var a=4*n*t.width+4*r,i=t.data[a+3];0==i&&(t.data[a]=255,t.data[a+1]=255,t.data[a+2]=255),t.data[a+3]=255,e[n][r]=t.data[4*n*t.width+4*r+0]/255}}return e},handleDrawMouseUp:function(){if(this.drawing){this.drawing=!1;var t=this.$refs.mnistDraw.getContext("2d"),e=t.getImageData(0,0,280,280),n=this.imageDataToGrayscale(e),r=this.getBoundingRectangle(n,.01),a=this.centerImage(n),i=document.createElement("canvas");i.width=e.width,i.height=e.height;var s=i.getContext("2d"),o=r.maxX+1-r.minX,u=r.maxY+1-r.minY,l=190/Math.max(o,u);s.translate(this.$refs.mnistDraw.width/2,this.$refs.mnistDraw.height/2),s.scale(l,l),s.translate(-this.$refs.mnistDraw.width/2,-this.$refs.mnistDraw.height/2),s.translate(a.transX,a.transY),s.drawImage(t.canvas,0,0);var c=this.$refs.mnistHidden.getContext("2d");c.clearRect(0,0,28,28),c.drawImage(i,0,0,28,28),this.makePrediction()}},handleClear:function(){var t=this.$refs.mnistDraw.getContext("2d");t.clearRect(0,0,300,300),this.answer=null},makePrediction:function(){var t=Object(v["a"])(regeneratorRuntime.mark(function t(){var e,n,r,a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=w["div"](w["fromPixels"](this.$refs.mnistHidden,4).asType("float32"),255),n=e.slice([0,0,3],[28,28,1]).expandDims(),r=this.model.predict(n),a=w["argMax"](r.squeeze()),t.next=6,a.data();case 6:i=t.sent,s=Object(p["a"])(i,1),this.answer=s[0];case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},created:function(){var t=Object(v["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w["loadModel"]("models/mnist/model.json");case 2:this.model=t.sent;case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},M=g,b=(n("7cbb"),Object(s["a"])(M,h,m,!1,null,null,null));b.options.__file="MiniMnist.vue";var x=b.exports,y={name:"home",components:{MiniMnist:x}},D=y,_=Object(s["a"])(D,f,d,!1,null,null,null);_.options.__file="Home.vue";var P=_.exports;r["a"].use(c["a"]);var j=new c["a"]({routes:[{path:"/",name:"home",component:P}]}),O=n("2f62");r["a"].use(O["a"]);var $=new O["a"].Store({state:{},mutations:{},actions:{}});r["a"].config.productionTip=!1,new r["a"]({router:j,store:$,render:function(t){return t(l)}}).$mount("#app")},"64a9":function(t,e,n){},"7cbb":function(t,e,n){"use strict";var r=n("255f"),a=n.n(r);a.a},b994:function(t,e){t.exports=tf}});
//# sourceMappingURL=app.be4c53f4.js.map