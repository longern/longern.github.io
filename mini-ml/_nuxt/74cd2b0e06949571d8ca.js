(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{290:function(e,t,r){"use strict";r(291)("sub",function(e){return function(){return e(this,"sub","","")}})},291:function(e,t,r){var n=r(7),i=r(11),a=r(22),s=/"/g,o=function(e,t,r,n){var i=String(a(e)),o="<"+t;return""!==r&&(o+=" "+r+'="'+String(n).replace(s,"&quot;")+'"'),o+">"+i+"</"+t+">"};e.exports=function(e,t){var r={};r[e]=t(o),n(n.P+n.F*i(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",r)}},292:function(e,t,r){var n=r(306);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,r(47).default)("61354c9a",n,!0,{})},305:function(e,t,r){"use strict";var n=r(292);r.n(n).a},306:function(e,t,r){(e.exports=r(46)(!1)).push([e.i,".deblur-gan .el-row{margin-bottom:16px}.deblur-gan .image-block{display:inline-block}",""])},332:function(e,t,r){"use strict";r.r(t);r(39),r(104),r(290),r(65);var n=r(5),i=r.n(n),a={name:"DeblurGAN",data:function(){return{model:null,processing:!1}},mounted:function(){var e=i()(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tf.loadLayersModel("models/deblur_gan/model.json");case 2:return this.model=e.sent,t=tf.zeros([1,256,256,3]),r=this.model.predict(t),e.next=7,r.data();case 7:t.dispose(),r.dispose();case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{handleFileChange:function(){var e=this;if(this.$refs.uploader.files.length){var t=this.$refs.uploader.files[0],r=URL.createObjectURL(t),n=new Image;n.onload=function(){n.width=224*Math.ceil((n.width-32)/224)+32,n.height=224*Math.ceil((n.height-32)/224)+32,e.makePrediction(n)},n.src=r,this.$refs.deblurGANInput.src=r}},handleSampleClick:function(){var e=this,t=new Image;t.onload=function(){t.width=224*Math.ceil((t.width-32)/224)+32,t.height=224*Math.ceil((t.height-32)/224)+32,e.makePrediction(t)},t.src=this.$refs.sample.src,this.$refs.deblurGANInput.src=this.$refs.sample.src},makePrediction:function(){var e=i()(regeneratorRuntime.mark(function e(t){var r,n,a,s,o,c,u,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){var e=i()(regeneratorRuntime.mark(function e(){var t,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(c>=o.length)){e.next=8;break}return t=tf.tidy(function(){for(var e=u.map(function(e){var t=tf.tensor(e,[256,256,3]).slice([16,16],[224,224]);return tf.clipByValue(tf.add(t,.5),0,1)}),t=[],r=0;r<n;r+=1)t[r]=tf.concat(e.slice(r*a,(r+1)*a),1);return tf.concat(t)}),i=document.createElement("canvas"),e.next=5,tf.browser.toPixels(t,i);case 5:return i.toBlob(function(e){l.$refs.deblurGANResult.src=URL.createObjectURL(e),l.processing=!1}),t.dispose(),e.abrupt("return");case 8:return l.processing=!0,s=tf.tidy(function(){return l.model.predict(tf.tensor(o[c],[1,256,256,3]))}),e.next=12,s.data();case 12:return u[c]=e.sent,s.dispose(),c+=1,e.next=17,tf.nextFrame();case 17:setTimeout(r,0);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),n=Math.ceil((t.height-32)/224),a=Math.ceil((t.width-32)/224),s=tf.tidy(function(){for(var e=tf.browser.fromPixels(t).asType("float32"),r=tf.sub(tf.div(e,255),.5),i=[],s=0;s<n;s+=1)for(var o=0;o<a;o+=1)i.push(r.slice([224*s,224*o],[256,256]));return i}),e.next=6,Promise.all(s.map(function(e){return e.data()}));case 6:return o=e.sent,s.forEach(function(e){return e.dispose()}),c=0,u=[],e.next=12,tf.nextFrame();case 12:r();case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}},s=(r(305),r(23)),o=Object(s.a)(a,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:!e.model,expression:"!model"}],staticClass:"deblur-gan"},[r("el-row",[r("div",{staticClass:"image-block"},[r("img",{ref:"deblurGANInput",attrs:{id:"deblur-gan-input",width:"360",height:"360"}})]),e._v(" "),r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.processing,expression:"processing"}],staticClass:"image-block"},[r("img",{ref:"deblurGANResult",attrs:{id:"deblur-gan-result",width:"360",height:"360"}})])]),e._v(" "),r("el-row",[r("el-button",{on:{click:function(t){e.$refs.uploader.click()}}},[e._v("\n      打开图片\n    ")]),e._v(" "),r("input",{ref:"uploader",attrs:{type:"file",hidden:""},on:{change:e.handleFileChange}})],1),e._v(" "),r("el-row",[r("img",{ref:"sample",attrs:{src:"static/sample1.png",width:"64",height:"64"},on:{click:e.handleSampleClick}})]),e._v(" "),r("el-row",[r("a",{attrs:{href:"https://arxiv.org/abs/1711.07064",target:"_blank"}},[e._v("\n      DeblurGAN: Blind Motion Deblurring Using Conditional Adversarial Networks\n    ")])])],1)},[],!1,null,null,null);o.options.__file="deblurgan.vue";t.default=o.exports}}]);