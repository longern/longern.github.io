(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{290:function(e,t,n){"use strict";n(291)("sub",function(e){return function(){return e(this,"sub","","")}})},291:function(e,t,n){var r=n(7),i=n(11),a=n(22),s=/"/g,o=function(e,t,n,r){var i=String(a(e)),o="<"+t;return""!==n&&(o+=" "+n+'="'+String(r).replace(s,"&quot;")+'"'),o+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(o),r(r.P+r.F*i(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",n)}},292:function(e,t,n){var r=n(306);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,n(47).default)("61354c9a",r,!0,{})},305:function(e,t,n){"use strict";var r=n(292);n.n(r).a},306:function(e,t,n){(e.exports=n(46)(!1)).push([e.i,".deblur-gan .el-row{margin-bottom:16px}.deblur-gan .image-block{display:inline-block}",""])},332:function(e,t,n){"use strict";n.r(t);n(290),n(65);var r=n(5),i=n.n(r),a={name:"DeblurGAN",data:function(){return{model:null,processing:!1}},mounted:function(){var e=i()(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tf.loadLayersModel("models/deblur_gan/model.json");case 2:return this.model=e.sent,window.model=this.model,t=tf.zeros([1,256,256,3]),n=this.model.predict(t),e.next=8,n.data();case 8:t.dispose(),n.dispose();case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{handleFileChange:function(){var e=this;if(this.$refs.uploader.files.length){var t=this.$refs.uploader.files[0],n=URL.createObjectURL(t),r=new Image;r.onload=function(){r.width=224*Math.ceil((r.width-32)/224)+32,r.height=224*Math.ceil((r.height-32)/224)+32,e.makePrediction(r)},r.src=n,this.$refs.deblurGANInput.src=n}},handleSampleClick:function(){var e=this,t=new Image;t.onload=function(){t.width=224*Math.ceil((t.width-32)/224)+32,t.height=224*Math.ceil((t.height-32)/224)+32,e.makePrediction(t)},t.src=this.$refs.sample.src,this.$refs.deblurGANInput.src=this.$refs.sample.src},makePrediction:function(){var e=i()(regeneratorRuntime.mark(function e(t){var n,r,i,a,s,o,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.processing=!0,n=Math.ceil((t.height-32)/224),r=Math.ceil((t.width-32)/224),i=tf.tidy(function(){for(var e=tf.browser.fromPixels(t).asType("float32"),i=tf.sub(tf.div(e,255),.5),a=[],s=0;s<n;s+=1)for(var o=0;o<r;o+=1)a.push(i.slice([224*s,224*o],[256,256]));return tf.stack(a)}),a=tf.tidy(function(){for(var e=l.model.predict(i,{batchSize:1}),t=tf.clipByValue(tf.add(e,.5),0,1).slice([0,16,16],[-1,224,224]).unstack(),a=[],s=0;s<n;s+=1)a[s]=tf.concat(t.slice(s*r,(s+1)*r),1);return tf.concat(a)}),s=document.createElement("canvas"),o=this.$refs.deblurGANResult,e.next=9,this.$nextTick();case 9:return e.next=11,tf.nextFrame();case 11:console.log(performance.now()),tf.browser.toPixels(a,s).then(function(){console.log(performance.now()),s.toBlob(function(e){o.src=URL.createObjectURL(e),l.processing=!1}),a.dispose()});case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}},s=(n(305),n(23)),o=Object(s.a)(a,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:!e.model,expression:"!model"}],staticClass:"deblur-gan"},[n("el-row",[n("div",{staticClass:"image-block"},[n("img",{ref:"deblurGANInput",attrs:{id:"deblur-gan-input",width:"360",height:"360"}})]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.processing,expression:"processing"}],staticClass:"image-block"},[n("img",{ref:"deblurGANResult",attrs:{id:"deblur-gan-result",width:"360",height:"360"}})])]),e._v(" "),n("el-row",[n("el-button",{on:{click:function(t){e.$refs.uploader.click()}}},[e._v("\n      打开图片\n    ")]),e._v(" "),n("input",{ref:"uploader",attrs:{type:"file",hidden:""},on:{change:e.handleFileChange}})],1),e._v(" "),n("el-row",[n("img",{ref:"sample",attrs:{src:"static/sample1.png",width:"64",height:"64"},on:{click:e.handleSampleClick}})]),e._v(" "),n("el-row",[n("a",{attrs:{href:"https://arxiv.org/abs/1711.07064",target:"_blank"}},[e._v("\n      DeblurGAN: Blind Motion Deblurring Using Conditional Adversarial Networks\n    ")])])],1)},[],!1,null,null,null);o.options.__file="deblurgan.vue";t.default=o.exports}}]);